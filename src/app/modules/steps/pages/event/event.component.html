<div class="p-4">
    <!-- Contenedor para el titulo -->
    
    <!-- Contenedor para los formularios -->
    <div *ngIf="!sheduleEvent; else final">
        <div class="pb-4">
            <h2 class="font-bold text-xl mb-2 md:text-3xl">Datos del Evento</h2>
            <span class="block font-medium text-sm text-gray-400">Ingrese los datos para el evento/capacitacion que se realizará.</span>
        </div>
        <form [formGroup]="eventForm">
            <!-- Contenedor para el titulo del evento -->
            <div [ngClass]="{'mb-2': invalidInput('title'), 'mb-4': !invalidInput('title')}">
                <label for="title">Título del evento *</label>
                <!-- Contenedor para hacer el input group -->
                <div class="flex">
                    <span class="inline-block p-2 bg-gray-400 rounded-l-md text-white"> {{ typeService  }}: </span>
                    <input [ngClass]="{'border-red-400': invalidInput('title')}" class="block w-full pl-3 border-r border-y rounded-r-md outline-none transition-colors " type="text" placeholder="Realización pruebas saber..." id="title" formControlName="title">
                </div>
                <span *ngIf="invalidInput('title')" class="block py-2 text-red-500">El titulo del evento es obligatorio. Ejemplo "Capacitación pruebas saber pro 2023"</span>
            </div>

            <!-- Contenedor para asistentes, fecha y horario -->
            <div class="w-full">
                <!-- contenedor para asistentes y fechas -->
                <div class="lg:flex lg:mb-4 gap-8">
                    <!-- asistentes -->
                    <div class="lg:w-1/2 mb-2">
                        <label for="">Personas a Asistir *</label>
                        <div class="flex  rounded-lg">
                            <span class="inline-block p-2 bg-gray-400 rounded-l-md text-white">
                                <i class="pi pi-users"></i>    
                            </span>
                            <input [ngClass]="{'border-red-400': invalidInput('people')}" class="block w-full pl-3 border-r border-y rounded-r-md outline-none transition-colors" type="text" [placeholder]="setMinPeopleValitador()" formControlName="people">
                        </div>
                        <span *ngIf="invalidInput('people')" class="block py-2 text-red-500"> {{getErrorPeopleMessage()}} </span>
                    </div>
                    <!-- fecha -->
                    <div class="lg:w-1/2 mb-2">
                        <label for="date">Fecha de Realización *</label>
                        <div class="flex rounded-md">
                            <div class="flex">
                                <span class="flex items-center justify-center h-full p-2  bg-gray-400 rounded-l-md text-white">
                                    <i class="pi pi-calendar"></i>    
                                </span>
                            </div>
                            <div class="w-full p-fluid">
                                <!-- (onSelect)="algo()"  -->
                                <p-calendar formControlName="date" (onSelect)="getFormatDate()"  [minDate]="minDate" [maxDate]="maxDate" [disabledDates]="disableDates" [disabledDays]="[0]"   dateFormat="dd/mm/yy" ></p-calendar>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- contenedor para los horarios -->
                <div class="mb-4 gap-8 lg:flex">
                    <!-- horario de inicio -->
                    <div class="mb-2 lg:w-1/2 ">
                        <label for="">Hora de inicio *</label>
                        <div class="flex" >
                            <span class="inline-block p-2 bg-gray-400 rounded-l-md text-white"> 
                                <i class="pi pi-clock"></i>
                            </span>
                            <div class="w-full p-fluid">
                                <p-dropdown [options]="start" optionLabel="hours" placeholder="Seleccione la hora de inicio" (onClick)="clearEndHoursList()" (onChange)="endTimes($event)" formControlName="start"></p-dropdown>
                            </div>
                        </div>
                    </div>
                    <!-- horario de fin -->
                    <div class="lg:w-1/2">
                        <label for="">Hora de finalización *</label>
                        <div class="flex">
                            <span class="inline-block p-2 bg-gray-400 rounded-l-md text-white"> 
                                <i class="pi pi-clock"></i>
                            </span>
                            <div class="w-full p-fluid">
                                <p-dropdown [options]="endHours" optionLabel="hour" placeholder="Seleccione la hora de fin" formControlName="end" ></p-dropdown>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex justify-between">
                <a routerLink="/eventos/personal-info" class="flex py-1 px-3 mt-4 rounded-md text-gray-400"
                   (click) = 'back()'    >Anterior</a>

                <button type="button" class="flex  py-1 px-3 mt-4 rounded-md text-white transition-colors"
                        (click)="submit()"
                        [disabled]="eventForm.invalid"
                        [ngClass]="{'bg-gray-400 cursor-not-allowed': eventForm.invalid, 'bg-red-600 hover:bg-red-500': eventForm.valid}">Agendar</button>
            </div>
        </form>
    </div>

    <!-- contenedor final de agendamiento del evento -->
    <ng-template #final>
        <div *ngIf="showLoading; else show" class="flex flex-col items-center justify-center w-full h-[374px]" >
            <span class="loader"></span>
            <div class="mt-12 text-center p-2">
                <span class="font-medium">¡Espera un momento. Estamos agendando el evento!</span>
            </div>
        </div>
        <ng-template #show>
            <div class="px-2">
                <!-- Encabezado -->
                <div class="flex items-center justify-center mb-4">
                  <img src="assets/logo-colors.png" alt="icono de check" class="w-44 max-w-full">
                </div>
              
                <!-- Texto de agradecimiento -->
                <div>
                  <h2 class="text-2xl font-bold mb-5 text-center">¡Evento Agendado!</h2>
                  <div class="text-sm mb-6 max-w-lg mx-auto">
                        <p >
                            De acuerdo a su solicitud, me permito informar que está autorizado {{getFinalMessage()}} para el día <span class="font-bold">{{ Ticket.event.date[8] + Ticket.event.date[9]  }}</span> de <span class="font-bold"></span> en el horario de <span class="font-bold">{{ Ticket.event.start }}</span> a <span class="font-bold">{{ Ticket.event.end }}</span>. 
                        </p>
                        <p class="py-3">
                            Esté fue agendado a cuenta institucional en Google calendar. En caso de que el evento no se vaya a realizar, por favor comunicarlo a través del correo  a
                            <a href="mailto:biblioteca@ufps.edu.co" class="text-red-400">biblioteca@ufps.edu.co</a> con anterioridad.
                        </p>  
                        <p class="font-semibold" *ngIf="Ticket.service.physicalSpace != 'BD'; else alter ">
                            Adicionalmente, es importante que descargue el formato que sustenta que se realizo el préstamo del espacio. No necesita imprimirlo.
                            <button  (click)="download()" 
                                class="block bg-red-500 hover:bg-red-700 text-white text-center font-normal py-2 px-4 my-3 rounded border  transition-colors w-full">
                                    Descargar Formato
                                    <i class="ml-4 pi pi-download"></i>
                        </button>
                        </p>
                        <ng-template #alter>
                            <p>
                                Al finalizar la sesión se tomará asistencia a través de los correos institucionales y se enviará certificado digital de la participación. <br>
                            </p>
                        </ng-template>
                        <!-- <p>La sesión se cerrará en {{countDown}}</p> -->
                    </div>
                    
                  <!-- Botón para descargar archivo -->
                  
              
                  <!-- Firma del jefe -->
                  <!-- <div class="mx-auto">
                    <img src="assets/Firma Jefe.png" alt="Firma del jefe" class="w-64 max-w-full">
                  </div> -->
                </div>
              </div>
        </ng-template>
    </ng-template>
</div>
